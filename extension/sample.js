

var result = null;

let contextMenuItem = {
    "id": "sendLink",
    "title": "Send to malware analysis server",
    "contexts": ["link"]
};

chrome.contextMenus.create(contextMenuItem);

//grabs link as a string
chrome.contextMenus.onClicked.addListener(function(info, tab){



  var selectedLink = info.linkUrl.toString();


   //reset status on click on contextmenu
   fetch('http://localhost:5000/reset', {
    method: 'post',
    headers: {
        'Content-Type': 'application/json'
      },
    body: JSON.stringify(selectedLink)
  }).then(function(r) {
    return r.json();
  }).then(function(data) {
    console.log(data);
  });  
  

   //send Link from contextmenu to server
    fetch('http://localhost:5000/receive', {
        method: 'post',
        headers: {
            'Content-Type': 'application/json'
          },
        body: JSON.stringify(selectedLink)
      }).then(function(r) {
        return r.json();
      }).then(function(data) {
        console.log(data);
      });  

});


